# Development Dockerfile for Next.js Web App
FROM node:22-alpine

# Install pnpm and dependencies for native modules
RUN apk add --no-cache libc6-compat python3 make g++
RUN corepack enable && corepack prepare pnpm@9.14.4 --activate

WORKDIR /app/apps/web

# Copy package files
COPY apps/web/package.json apps/web/pnpm-lock.yaml* ./

# Install dependencies
RUN pnpm install --no-frozen-lockfile

# Copy application source
COPY apps/web .

EXPOSE 3000

# Start development server
ENV HOSTNAME="0.0.0.0"
CMD ["pnpm", "run", "dev"]
